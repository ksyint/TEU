model:
  pretrained_model_name_or_path: stabilityai/stable-diffusion-xl-base-1.0
  revision: null
  variant: null
  image_reward_path: outputs/image_reward/best_model.pth
  use_lora: true
  lora_rank: 4
  prediction_type: null
  use_ema: false

data:
  train_data_dir: data/rlhf_data.json
  dataset_name: null
  dataset_config_name: null
  image_column: image
  caption_column: text
  id_column: id
  image_base_dir: data/images/
  cache_dir: null
  max_train_samples: null
  mapping_batch_size: 128

training:
  seed: 42
  train_batch_size: 4
  num_train_epochs: 100
  max_train_steps: 5000
  gradient_accumulation_steps: 4
  gradient_checkpointing: true
  learning_rate: 1.0e-04
  scale_lr: false
  lr_scheduler: constant
  lr_warmup_steps: 500
  use_8bit_adam: false
  adam_beta1: 0.9
  adam_beta2: 0.999
  adam_weight_decay: 0.01
  adam_epsilon: 1.0e-08
  max_grad_norm: 1.0
  resolution: 1024
  center_crop: false
  random_flip: false
  apply_pre_loss: true
  apply_reward_loss: true
  grad_scale: 0.001
  snr_gamma: null
  noise_offset: 0.0
  allow_tf32: true

validation:
  validation_prompts:
    - a beautiful sunset over the ocean
    - a cat sitting on a windowsill
  checkpointing_steps: 500
  checkpoints_total_limit: 5
  validation_epochs: 5

logging:
  output_dir: outputs/rlhf_sdxl/
  logging_dir: logs
  report_to: wandb
  run_name: rlhf-sdxl-train

device:
  mixed_precision: bf16
  enable_xformers: true
  local_rank: -1
